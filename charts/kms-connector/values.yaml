common_config:
  enabled: true
  database:
    secret:
      name: kms-connector-db-url
      key: kms-connector-db-url
      value: "postgresql://postgres:postgres@postgresql:5432/kms-connector"
  env:
    - name: KMS_CONNECTOR_DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: kms-connector-db-url
          key: kms-connector-db-url
    - name: KMS_CONNECTOR_GATEWAY_URL
      value: ws://gateway-anvil-node:8546
    - name: KMS_CONNECTOR_CHAIN_ID
      value: 54321
    - name: KMS_CONNECTOR_DECRYPTION_CONTRACT__ADDRESS
      value: "0xc9bAE822fE6793e3B456144AdB776D5A318CB71e"
    - name: KMS_CONNECTOR_GATEWAY_CONFIG_CONTRACT__ADDRESS
      value: "0xeAC2EfFA07844aB326D92d1De29E136a6793DFFA"
    - name: KMS_CONNECTOR_KMS_MANAGEMENT_CONTRACT__ADDRESS
      value: "0xF0bFB159C7381F7CB332586004d8247252C5b816"

monitoring_config:
  env:
    - name: OTEL_EXPORTER_OTLP_ENDPOINT
      value: http://otlp-endpoint:4317

kmsConnectorDbMigration:
  enabled: true
  annotations:
#    "helm.sh/hook": "pre-install, pre-upgrade"
#    "helm.sh/hook-weight": "0"
#    "helm.sh/hook-needs": "config-setup"
  image:
    name: ghcr.io/zama-ai/fhevm/kms-connector/db-migration
    tag: v0.8.0-1
  env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: kms-connector-db-url
          key: kms-connector-db-url
  serviceAccountName:
  storage:
    size: 2Gi
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  affinity:
    enabled: false
  tolerations:
    enabled: false
    items: []

kmsConnectorGwListener:
  enabled: false
  nameOverride:
  image:
    name: ghcr.io/zama-ai/fhevm/kms-connector/gw-listener
    tag: v0.8.0-1
  replicas: 1
  env:
    - name: KMS_CONNECTOR_SERVICE_NAME
      value: kms-connector-gw-listener
  tracing:
    enabled: true
  ports:
    monitoring: 9100
  serviceMonitor:
    enabled: false
  serviceAccountName:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  probes:
    liveness:
      enabled: false
      httpGet:
        path: /liveness
        port: monitoring
      initialDelaySeconds: 10
      periodSeconds: 10
    readiness:
      enabled: false
      httpGet:
        path: /healthz
        port: monitoring
      initialDelaySeconds: 5
      periodSeconds: 10
  affinity:
    enabled: false
  tolerations:
    enabled: false
    items: []
  updateStrategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0

kmsConnectorKmsWorker:
  enabled: false
  nameOverride:
  image:
    name: ghcr.io/zama-ai/fhevm/kms-connector/kms-worker
    tag: v0.8.0-1
  replicas: 1
  env:
    - name: KMS_CONNECTOR_SERVICE_NAME
      value: kms-connector-kms-worker
    - name: KMS_CONNECTOR_KMS_CORE_ENDPOINT
      value: http://kms-core:50051
  tracing:
    enabled: true
  ports:
    monitoring: 9100
  serviceMonitor:
    enabled: false
  serviceAccountName:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  probes:
    liveness:
      enabled: false
      httpGet:
        path: /liveness
        port: monitoring
      initialDelaySeconds: 10
      periodSeconds: 10
    readiness:
      enabled: false
      httpGet:
        path: /healthz
        port: monitoring
      initialDelaySeconds: 5
      periodSeconds: 10
  affinity:
    enabled: false
  tolerations:
    enabled: false
    items: []
  updateStrategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0

kmsConnectorTxSender:
  enabled: false
  nameOverride:
  image:
    name: ghcr.io/zama-ai/fhevm/kms-connector/tx-sender
    tag: v0.8.0-1
  replicas: 1
  env:
    - name: KMS_CONNECTOR_SERVICE_NAME
      value: kms-connector-tx-sender
    - name: KMS_CONNECTOR_AWS_KMS_CONFIG__KEY_ID
      valueFrom:
        secretKeyRef:
          name: kms-connector-tx-sender.aws-kms-wallet
          key: kms-connector-tx-sender.aws-kms-wallet
  wallet:
    secret:
      name: wallet
      key: kms-connector-tx-sender.aws-kms-wallet
      value: ""
  tracing:
    enabled: true
  ports:
    monitoring: 9100
  serviceMonitor:
    enabled: false
  serviceAccountName:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  probes:
    liveness:
      enabled: false
      httpGet:
        path: /liveness
        port: monitoring
      initialDelaySeconds: 10
      periodSeconds: 10
    readiness:
      enabled: false
      httpGet:
        path: /healthz
        port: monitoring
      initialDelaySeconds: 5
      periodSeconds: 10
  affinity:
    enabled: false
  tolerations:
    enabled: false
    items: []
  updateStrategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0

# Set Pod Annotations, see: https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/
podAnnotations: {}
# Set Pod Labels, see: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/
podLabels: {}

podSecurityContext:
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000
  runAsNonRoot: true
