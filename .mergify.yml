queue_rules:
  - name: main
    batch_size: 3
    batch_max_wait_time: 4h
    checks_timeout: 12h
    merge_method: squash
    update_method: rebase
    merge_conditions:
      - check-success = test-suite-e2e-tests/fhevm-e2e-test (bpr)
    queue_conditions:
      - base = main
      - "#approved-reviews-by >= 1"
      - label!=do-not-merge
      - check-success = common-pull-request/lint (bpr)
      - check-neutral = common-pull-request/lint (bpr)
      - check-skipped = common-pull-request/lint (bpr)
      - check-success = charts-helm-checks/test (bpr)
      - check-neutral = charts-helm-checks/test (bpr)
      - check-skipped = charts-helm-checks/test (bpr)
      - check-success = coprocessor-dependency-analysis/dependencies-check (bpr)
      - check-neutral = coprocessor-dependency-analysis/dependencies-check (bpr)
      - check-skipped = coprocessor-dependency-analysis/dependencies-check (bpr)
      - check-success = coprocessor-tx-sender-docker-build/build (bpr)
      - check-neutral = coprocessor-tx-sender-docker-build/build (bpr)
      - check-skipped = coprocessor-tx-sender-docker-build/build (bpr)
      - check-success = coprocessor-cargo-test/cargo-tests (bpr)
      - check-neutral = coprocessor-cargo-test/cargo-tests (bpr)
      - check-skipped = coprocessor-cargo-test/cargo-tests (bpr)
      - check-success = coprocessor-cargo-listener-tests/cargo-tests (bpr)
      - check-neutral = coprocessor-cargo-listener-tests/cargo-tests (bpr)
      - check-skipped = coprocessor-cargo-listener-tests/cargo-tests (bpr)
      - check-success = coprocessor-db-migration-docker-build/build (bpr)
      - check-neutral = coprocessor-db-migration-docker-build/build (bpr)
      - check-skipped = coprocessor-db-migration-docker-build/build (bpr)
      - check-success = host-contracts-hardhat-forge-tests/build (bpr)
      - check-neutral = host-contracts-hardhat-forge-tests/build (bpr)
      - check-skipped = host-contracts-hardhat-forge-tests/build (bpr)
      - check-success = host-contracts-docker-deployment-tests/docker-compose-tests (bpr)
      - check-neutral = host-contracts-docker-deployment-tests/docker-compose-tests (bpr)
      - check-skipped = host-contracts-docker-deployment-tests/docker-compose-tests (bpr)
      - check-success = host-contracts-slither-analysis/analyze (bpr)
      - check-neutral = host-contracts-slither-analysis/analyze (bpr)
      - check-skipped = host-contracts-slither-analysis/analyze (bpr)
      - check-success = host-contracts-docker-build/build (bpr)
      - check-neutral = host-contracts-docker-build/build (bpr)
      - check-skipped = host-contracts-docker-build/build (bpr)
      - check-success = gateway-contracts-integrity-checks/contract-integrity-checks (bpr)
      - check-neutral = gateway-contracts-integrity-checks/contract-integrity-checks (bpr)
      - check-skipped = gateway-contracts-integrity-checks/contract-integrity-checks (bpr)
      - check-success = gateway-contracts-deployment-tests/sc-deploy (bpr)
      - check-neutral = gateway-contracts-deployment-tests/sc-deploy (bpr)
      - check-skipped = gateway-contracts-deployment-tests/sc-deploy (bpr)
      - check-success = gateway-contracts-hardhat-tests/tests (bpr)
      - check-neutral = gateway-contracts-hardhat-tests/tests (bpr)
      - check-skipped = gateway-contracts-hardhat-tests/tests (bpr)
      - check-success = gateway-contracts-docker-build/docker-hardhat-test (bpr)
      - check-neutral = gateway-contracts-docker-build/docker-hardhat-test (bpr)
      - check-skipped = gateway-contracts-docker-build/docker-hardhat-test (bpr)
      - check-success = gateway-contracts-mock-deployment/deploy (bpr)
      - check-neutral = gateway-contracts-mock-deployment/deploy (bpr)
      - check-skipped = gateway-contracts-mock-deployment/deploy (bpr)
      - check-success = gateway-contracts-hardhat-tests-docker/test (bpr)
      - check-neutral = gateway-contracts-hardhat-tests-docker/test (bpr)
      - check-skipped = gateway-contracts-hardhat-tests-docker/test (bpr)
      - check-success = gateway-contracts-upgrade-tests/sc-upgrade (bpr)
      - check-neutral = gateway-contracts-upgrade-tests/sc-upgrade (bpr)
      - check-skipped = gateway-contracts-upgrade-tests/sc-upgrade (bpr)
      - check-success = kms-connector-tests/test-connector (bpr)
      - check-neutral = kms-connector-tests/test-connector (bpr)
      - check-skipped = kms-connector-tests/test-connector (bpr)
      - check-success = kms-connector-db-migration-docker-build/build (bpr)
      - check-neutral = kms-connector-db-migration-docker-build/build (bpr)
      - check-skipped = kms-connector-db-migration-docker-build/build (bpr)
      - check-success = kms-connector-dependency-analysis/dependencies-check (bpr)
      - check-neutral = kms-connector-dependency-analysis/dependencies-check (bpr)
      - check-skipped = kms-connector-dependency-analysis/dependencies-check (bpr)
      - check-success = sdk-rust-sdk-tests/test-rust-sdk (bpr)
      - check-neutral = sdk-rust-sdk-tests/test-rust-sdk (bpr)
      - check-skipped = sdk-rust-sdk-tests/test-rust-sdk (bpr)
      - check-success = library-solidity-hardhat-tests/build (bpr)
      - check-neutral = library-solidity-hardhat-tests/build (bpr)
      - check-skipped = library-solidity-hardhat-tests/build (bpr)
      - check-success = test-suite-docker-build/docker-e2e-image (bpr)
      - check-neutral = test-suite-docker-build/docker-e2e-image (bpr)
      - check-skipped = test-suite-docker-build/docker-e2e-image (bpr)
pull_request_rules:
  - name: Auto-queue PRs
    description: Queue a PR when developer comments `@mergify queue`
    conditions:
      - base = main
      - "#approved-reviews-by >= 1"
    actions:
      queue:

  - name: Add a queue label when PR is queued
    description: Toggle the `merge-queued` label when a pull request is (un)queued.
    conditions:
      - queue-position > 0
    actions:
      label:
        toggle:
          - merge-queued
  - name: autoqueue
    description: put PR in queue as soon as it matches the queue conditions
    conditions:
      - label=ready-to-merge
    actions:
      queue:
        name: main
