[package]
name = "solana-listener"
version = "0.1.0"
edition = "2021"
license.workspace = true

[features]
default = []
solana-e2e = [
    "dep:solana-sdk",
]

[[bin]]
path = "src/bin/main.rs"
name = "solana_listener"
test = false
bench = false

[[bin]]
path = "src/bin/solana_poc_runner.rs"
name = "solana_poc_runner"
test = false
bench = false
required-features = ["solana-e2e"]

[dependencies]
anyhow = { workspace = true }
async-trait = { workspace = true }
base64 = "0.22.1"
bs58 = "0.5.1"
clap = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true }
sqlx = { workspace = true }
time = { workspace = true }
tokio = { workspace = true }
tracing = { workspace = true }
tracing-subscriber = { workspace = true }
tracing-opentelemetry = { workspace = true }
hex = { workspace = true }
sha3 = { workspace = true }
urlencoding = "2.1.3"
anchor-lang = "0.32.1"
solana-pubkey = { version = "2.3.1", features = ["serde"] }
solana-client = { version = "3.1.8" }
solana-sdk = { version = "3.0.0", optional = true }
solana-commitment-config = { version = "3.1.0" }
zama_host = { path = "../../../solana/host-programs/zama-host", default-features = false, features = ["cpi"] }

fhevm-engine-common = { path = "../fhevm-engine-common" }

[dev-dependencies]
alloy = { workspace = true }
host-listener = { path = "../host-listener" }
reqwest = { workspace = true }
serial_test = { workspace = true }
testcontainers = { workspace = true }
tfhe-worker = { path = "../tfhe-worker" }
tonic = { workspace = true }
tfhe = { workspace = true }

[[test]]
name = "localnet_harness_integration"
path = "tests/localnet_harness_integration.rs"
required-features = ["solana-e2e"]
