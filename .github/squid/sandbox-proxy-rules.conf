# Strict domain allowlist for CI sandbox
# Only these domains are reachable through the Squid proxy.
# Based on: https://github.com/zama-ai/security-hub/tree/main/docs/how-tos/sandboxed-claude-code
#
# To add a new domain: append ".example.com" to the acl below.
# Leading dot means "this domain and all subdomains".

acl allowed_domains dstdomain \
  .anthropic.com \
  .claude.ai \
  .platform.claude.com \
  .github.com \
  .githubusercontent.com \
  .npmjs.org \
  .pypi.org \
  .pythonhosted.org \
  .googleapis.com

# Allow only explicitly allowed domains
http_access deny !allowed_domains
http_access allow allowed_domains

# Deny everything else
http_access deny all
